<!-- Modal Gerar Proposta em PDF -->
<div class="modal" id="modal-gerar-pdf">
  <div class="modal-content" style="max-width: 1200px; width: 95%; max-height: 95vh; display: flex; flex-direction: column;">
    <div class="modal-header" style="background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 1.5rem; flex-shrink: 0;">
      <h3 class="modal-title" style="font-size: 1.5rem; font-weight: 600;">
        <i class="fas fa-file-pdf"></i> Gerar Proposta em PDF
      </h3>
      <button class="close-modal" id="close-modal-gerar-pdf" style="color: white;">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div style="display: grid; grid-template-columns: 400px 1fr; gap: 0; flex: 1; overflow: hidden;">
      <!-- Painel de Configurações -->
      <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; overflow-y: auto; border-right: 2px solid rgba(173, 216, 230, 0.2);">
        <h4 style="color: #add8e6; margin: 0 0 1.5rem 0; font-size: 1.1rem; border-bottom: 2px solid rgba(173, 216, 230, 0.3); padding-bottom: 0.5rem;">
          <i class="fas fa-cog"></i> Configurações da Proposta
        </h4>

        <!-- Nome da Obra -->
        <div class="form-group" style="margin-bottom: 1.5rem;">
          <label class="form-label" for="pdf-nome-obra" style="color: #e0e0e0; font-weight: 500; margin-bottom: 0.5rem; display: block;">
            <i class="fas fa-building"></i> Nome da Obra
          </label>
          <input 
            type="text" 
            id="pdf-nome-obra" 
            class="form-input" 
            placeholder="Ex: Edifício Casa Boa Viagem"
            style="width: 100%; padding: 0.75rem; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(173, 216, 230, 0.3); border-radius: 6px; color: #e0e0e0;"
          >
          <small style="color: #808080; font-size: 0.85rem; margin-top: 0.3rem; display: block;">
            Deixe vazio para usar observações
          </small>
        </div>

        <!-- Representante -->
        <div class="form-group" style="margin-bottom: 1.5rem;">
          <label class="form-label" for="pdf-representante" style="color: #e0e0e0; font-weight: 500; margin-bottom: 0.5rem; display: block;">
            <i class="fas fa-user-tie"></i> Representante (Att:) *
          </label>
          <select 
            id="pdf-representante" 
            class="form-input" 
            required
            style="width: 100%; padding: 0.75rem; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(173, 216, 230, 0.3); border-radius: 6px; color: #e0e0e0;"
          >
            <option value="">Selecione um representante</option>
            <!-- Preenchido via JavaScript -->
          </select>
        </div>

        <!-- Opção -->
        <div class="form-group" style="margin-bottom: 1.5rem;">
          <label class="form-label" for="pdf-opcao" style="color: #e0e0e0; font-weight: 500; margin-bottom: 0.5rem; display: block;">
            <i class="fas fa-list-ol"></i> Opção
          </label>
          <input 
            type="text" 
            id="pdf-opcao" 
            class="form-input" 
            placeholder="Ex: OPÇÃO 1, OPÇÃO 2"
            style="width: 100%; padding: 0.75rem; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(173, 216, 230, 0.3); border-radius: 6px; color: #e0e0e0;"
          >
          <small style="color: #808080; font-size: 0.85rem; margin-top: 0.3rem; display: block;">
            Deixe vazio se houver apenas uma proposta
          </small>
        </div>

        <!-- Assinante -->
        <div class="form-group" style="margin-bottom: 1.5rem;">
          <label class="form-label" for="pdf-assinante" style="color: #e0e0e0; font-weight: 500; margin-bottom: 0.5rem; display: block;">
            <i class="fas fa-signature"></i> Assinante *
          </label>
          <select 
            id="pdf-assinante" 
            class="form-input" 
            required
            style="width: 100%; padding: 0.75rem; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(173, 216, 230, 0.3); border-radius: 6px; color: #e0e0e0;"
          >
            <option value="Hermógenes C. P. Viana">Hermógenes C. P. Viana</option>
            <option value="Hugo Távora Tavares Cavalcanti Viana">Hugo Távora Tavares Cavalcanti Viana</option>
          </select>
        </div>

        <!-- Formato -->
        <div class="form-group" style="margin-bottom: 1.5rem;">
          <label class="form-label" for="pdf-formato" style="color: #e0e0e0; font-weight: 500; margin-bottom: 0.5rem; display: block;">
            <i class="fas fa-file-alt"></i> Formato da Proposta *
          </label>
          <select 
            id="pdf-formato" 
            class="form-input" 
            required
            style="width: 100%; padding: 0.75rem; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(173, 216, 230, 0.3); border-radius: 6px; color: #e0e0e0;"
          >
            <option value="tabela">Tabela Profissional (Recomendado)</option>
            <option value="simples">Texto Simples</option>
          </select>
        </div>

        <!-- Botões de Ação -->
        <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 2px solid rgba(173, 216, 230, 0.2);">
          <button 
            type="button" 
            id="btn-atualizar-preview" 
            class="btn-primary" 
            style="width: 100%; margin-bottom: 1rem; padding: 0.75rem; font-size: 1rem;"
          >
            <i class="fas fa-sync-alt"></i> Atualizar Preview
          </button>
          
          <button 
            type="button" 
            id="btn-salvar-pdf" 
            class="btn-success" 
            style="width: 100%; padding: 0.75rem; font-size: 1rem; background: linear-gradient(135deg, #28a745, #218838);"
          >
            <i class="fas fa-save"></i> Salvar em PDF no OneDrive
          </button>
        </div>
      </div>

      <!-- Preview da Proposta -->
      <div style="background: white; padding: 2rem; overflow-y: auto;">
        <div style="text-align: center; margin-bottom: 1rem;">
          <span style="color: #808080; font-size: 0.9rem; font-style: italic;">
            <i class="fas fa-eye"></i> Preview da Proposta
          </span>
        </div>
        
        <div id="pdf-preview-container" style="max-width: 210mm; margin: 0 auto; background: white; box-shadow: 0 0 20px rgba(0,0,0,0.1); min-height: 297mm;">
          <!-- Preview será inserido aqui -->
          <div style="padding: 40px; text-align: center; color: #808080;">
            <i class="fas fa-file-pdf" style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.3;"></i>
            <p>Clique em "Atualizar Preview" para visualizar a proposta</p>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer" style="background: rgba(255, 255, 255, 0.03); padding: 1rem 2rem; flex-shrink: 0; border-top: 2px solid rgba(173, 216, 230, 0.2);">
      <button type="button" class="btn-secondary" id="close-gerar-pdf-btn">
        <i class="fas fa-times"></i> Fechar
      </button>
    </div>
  </div>
</div>

<!-- Modal Seletor de Pasta OneDrive -->
<div class="modal" id="modal-onedrive-folder">
  <div class="modal-content" style="max-width: 700px;">
    <div class="modal-header" style="background: linear-gradient(135deg, #0078D4, #005A9E); color: white;">
      <h3 class="modal-title">
        <i class="fab fa-microsoft"></i> Selecionar Pasta no OneDrive
      </h3>
      <button class="close-modal" id="close-modal-onedrive-folder" style="color: white;">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div style="padding: 2rem;">
      <!-- Breadcrumb -->
      <div id="onedrive-breadcrumb" style="background: rgba(0, 120, 212, 0.1); padding: 0.75rem 1rem; border-radius: 6px; margin-bottom: 1.5rem; font-size: 0.9rem; color: #0078D4;">
        <i class="fas fa-folder-open"></i> <span id="breadcrumb-path">Meu OneDrive</span>
      </div>

      <!-- Lista de Pastas -->
      <div id="onedrive-folders-list" style="max-height: 400px; overflow-y: auto; border: 1px solid rgba(173, 216, 230, 0.3); border-radius: 6px;">
        <!-- Pastas serão carregadas aqui -->
        <div style="padding: 2rem; text-align: center; color: #808080;">
          <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 1rem;"></i>
          <p>Carregando pastas...</p>
        </div>
      </div>

      <!-- Nome do Arquivo -->
      <div style="margin-top: 1.5rem;">
        <label for="pdf-filename-input" style="display: block; margin-bottom: 0.5rem; color: #e0e0e0; font-weight: 500;">
          <i class="fas fa-file-signature"></i> Nome do Arquivo:
        </label>
        <input 
          type="text" 
          id="pdf-filename-input" 
          placeholder="Ex: Proposta_1234_2025"
          style="width: 100%; padding: 0.75rem; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(173, 216, 230, 0.3); border-radius: 6px; color: #e0e0e0; font-size: 0.95rem;"
        >
        <small style="color: #808080; font-size: 0.85rem; margin-top: 0.3rem; display: block;">
          A extensão .pdf será adicionada automaticamente
        </small>
      </div>

      <!-- Pasta Selecionada -->
      <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(40, 167, 69, 0.1); border: 1px solid #28a745; border-radius: 6px;">
        <p style="margin: 0 0 0.5rem 0; color: #e0e0e0; font-size: 0.9rem;">
          <i class="fas fa-check-circle" style="color: #28a745;"></i> Pasta Selecionada:
        </p>
        <p id="selected-folder-path" style="margin: 0; color: #28a745; font-weight: 600;">
          Nenhuma pasta selecionada
        </p>
      </div>
    </div>

    <div class="modal-footer">
      <button type="button" class="btn-secondary" id="cancel-folder-selection">
        <i class="fas fa-times"></i> Cancelar
      </button>
      <button type="button" class="btn-success" id="confirm-folder-selection" disabled>
        <i class="fas fa-check"></i> Confirmar
      </button>
    </div>
  </div>
</div>


<!-- Modal de Confirmação de Sobrescrita -->
<div id="modal-confirm-overwrite" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 10000; align-items: center; justify-content: center;">
  <div style="background: #1a1a2e; border-radius: 12px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5); border: 2px solid rgba(173, 216, 230, 0.3);">
    <!-- Header -->
    <div style="background: linear-gradient(135deg, #dc3545, #c82333); color: white; padding: 1.5rem; border-radius: 10px 10px 0 0;">
      <h3 style="margin: 0; font-size: 1.3rem; font-weight: 600;">
        <i class="fas fa-exclamation-triangle"></i> Arquivo Já Existe
      </h3>
    </div>

    <!-- Body -->
    <div style="padding: 2rem;">
      <p style="color: #e0e0e0; margin: 0 0 1rem 0; font-size: 1rem; line-height: 1.6;">
        O arquivo <strong style="color: #add8e6;"><span id="existing-filename"></span></strong> já existe nesta pasta.
      </p>
      <p style="color: #e0e0e0; margin: 0; font-size: 1rem; line-height: 1.6;">
        Deseja sobrescrever o arquivo existente?
      </p>
    </div>

    <!-- Footer -->
    <div style="padding: 1rem 2rem 1.5rem; display: flex; gap: 1rem; justify-content: flex-end;">
      <button 
        type="button" 
        id="cancel-overwrite-btn" 
        style="padding: 0.75rem 1.5rem; background: #6c757d; color: white; border: none; border-radius: 6px; font-size: 1rem; cursor: pointer; transition: all 0.3s;"
        onmouseover="this.style.background='#5a6268'" 
        onmouseout="this.style.background='#6c757d'"
      >
        <i class="fas fa-times"></i> Cancelar
      </button>
      <button 
        type="button" 
        id="confirm-overwrite-btn" 
        style="padding: 0.75rem 1.5rem; background: linear-gradient(135deg, #dc3545, #c82333); color: white; border: none; border-radius: 6px; font-size: 1rem; cursor: pointer; transition: all 0.3s;"
        onmouseover="this.style.background='linear-gradient(135deg, #c82333, #bd2130)'" 
        onmouseout="this.style.background='linear-gradient(135deg, #dc3545, #c82333)'"
      >
        <i class="fas fa-check"></i> Sobrescrever
      </button>
    </div>
  </div>
</div>
