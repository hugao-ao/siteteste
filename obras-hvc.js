<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Obras HVC</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    /* Tema específico HVC */
    body {
      display: flex;
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #000080, #191970);
      color: #e0e0e0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    #main-content-obras-hvc {
      flex-grow: 1;
      padding: 2rem;
      margin-left: 250px;
      transition: margin-left 0.3s ease;
      background: linear-gradient(135deg, #000080, #191970);
      color: #e0e0e0;
    }

    #main-content-obras-hvc.sidebar-collapsed {
      margin-left: 60px;
    }

    /* Estilo HVC - Elegante e sofisticado */
    .hvc-container {
      background: rgba(25, 25, 112, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 8px 32px rgba(0, 0, 128, 0.3);
      backdrop-filter: blur(10px);
    }

    .hvc-title {
      color: #ffffff;
      text-shadow: 0 0 10px #ffffff, 0 0 20px #c0c0c0;
      font-size: 2rem;
      margin-bottom: 1.5rem;
      text-align: center;
    }

    .hvc-form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      align-items: end;
      margin-bottom: 2rem;
    }

    .hvc-input, .hvc-select, .hvc-textarea {
      width: 100%;
      padding: 0.8rem;
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      background: rgba(0, 0, 128, 0.2);
      color: #e0e0e0;
      font-size: 1rem;
      transition: all 0.3s ease;
      font-family: inherit;
    }

    .hvc-input:focus, .hvc-select:focus, .hvc-textarea:focus {
      outline: none;
      border-color: #ffffff;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
      background: rgba(0, 0, 128, 0.4);
    }

    .hvc-input::placeholder, .hvc-textarea::placeholder {
      color: rgba(224, 224, 224, 0.6);
    }

    .hvc-select option {
      background: #191970;
      color: #e0e0e0;
    }

    .hvc-btn {
      padding: 0.8rem 1.5rem;
      border: none;
      border-radius: 8px;
      background: linear-gradient(145deg, #000080, #191970);
      color: #e0e0e0;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      text-shadow: 0 0 5px #ffffff;
      box-shadow: 0 4px 15px rgba(0, 0, 128, 0.3);
    }

    .hvc-btn:hover {
      background: linear-gradient(145deg, #191970, #000080);
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }

    .hvc-btn-danger {
      background: linear-gradient(145deg, #8B0000, #DC143C);
    }

    .hvc-btn-danger:hover {
      background: linear-gradient(145deg, #DC143C, #8B0000);
    }

    .hvc-btn-success {
      background: linear-gradient(145deg, #006400, #228B22);
    }

    .hvc-btn-success:hover {
      background: linear-gradient(145deg, #228B22, #006400);
    }

    .hvc-btn-warning {
      background: linear-gradient(145deg, #FF8C00, #FFA500);
    }

    .hvc-btn-warning:hover {
      background: linear-gradient(145deg, #FFA500, #FF8C00);
    }

    .hvc-table {
      width: 100%;
      border-collapse: collapse;
      background: rgba(25, 25, 112, 0.2);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0, 0, 128, 0.3);
    }

    .hvc-table th {
      background: linear-gradient(145deg, #000080, #191970);
      color: #ffffff;
      padding: 1rem;
      text-align: left;
      font-weight: bold;
      text-shadow: 0 0 5px #ffffff;
      border-bottom: 2px solid rgba(255, 255, 255, 0.3);
    }

    .hvc-table td {
      padding: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      transition: background-color 0.3s ease;
    }

    .hvc-table tr:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    /* Status badges */
    .status-badge {
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: bold;
      text-align: center;
      display: inline-block;
      min-width: 100px;
    }

    .status-a-iniciar {
      background: linear-gradient(145deg, #FF8C00, #FFA500);
      color: #000;
    }

    .status-iniciado {
      background: linear-gradient(145deg, #4169E1, #6495ED);
      color: #fff;
    }

    .status-concluido {
      background: linear-gradient(145deg, #006400, #228B22);
      color: #fff;
    }

    .status-concluida {
      background: linear-gradient(145deg, #006400, #228B22);
      color: #fff;
    }

    .status-pagamento-pendente {
      background: linear-gradient(145deg, #8B0000, #DC143C);
      color: #fff;
    }

    /* Modal HVC */
    .hvc-modal {
      display: none;
      position: fixed;
      z-index: 1001;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
    }

    .hvc-modal-content {
      background: linear-gradient(135deg, #000080, #191970);
      margin: 2% auto;
      padding: 2rem;
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 8px 32px rgba(0, 0, 128, 0.5);
      color: #e0e0e0;
    }

    .hvc-modal-close {
      color: #ffffff;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .hvc-modal-close:hover {
      text-shadow: 0 0 15px #ffffff;
      transform: scale(1.1);
    }

    .servico-item, .medicao-item {
      background: rgba(25, 25, 112, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
    }

    .servico-controls {
      display: flex;
      gap: 1rem;
      align-items: center;
      margin-top: 0.5rem;
    }

    .toggle-btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    .toggle-btn.active {
      background: linear-gradient(145deg, #006400, #228B22);
      color: #fff;
    }

    .toggle-btn.inactive {
      background: rgba(255, 255, 255, 0.2);
      color: #e0e0e0;
    }

    .propostas-selection {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .proposta-checkbox {
      background: rgba(25, 25, 112, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .proposta-checkbox:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .proposta-checkbox.selected {
      border-color: #ffffff;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
    }

    .valor-display {
      font-size: 1.2rem;
      font-weight: bold;
      color: #ffffff;
      text-shadow: 0 0 5px #ffffff;
    }

    @media (max-width: 768px) {
      #main-content-obras-hvc {
        margin-left: 60px !important;
      }
      
      .hvc-form {
        grid-template-columns: 1fr;
      }
      
      .hvc-modal-content {
        width: 95%;
        margin: 5% auto;
      }
      
      .propostas-selection {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Sidebar será injetada aqui pelo sidebar.js -->
  <main id="main-content-obras-hvc">
    <div class="hvc-container">
      <h1 class="hvc-title">
        <i class="fas fa-building"></i> Obras HVC
      </h1>

      <!-- Formulário para Adicionar Obra -->
      <form id="add-obra-form" class="hvc-form">
        <input type="text" id="obra-numero" class="hvc-input" placeholder="Número da Obra (ex: 0001)" required />
        <div style="grid-column: 1 / -1;">
          <label style="display: block; margin-bottom: 0.5rem; color: #ffffff;">Propostas Aprovadas:</label>
          <div id="propostas-selection" class="propostas-selection">
            <!-- Propostas serão carregadas aqui -->
          </div>
        </div>
        <textarea id="obra-observacoes" class="hvc-textarea" placeholder="Observações da obra (opcional)" rows="3"></textarea>
        <button type="submit" class="hvc-btn">
          <i class="fas fa-plus"></i> Adicionar Obra
        </button>
      </form>
    </div>

    <!-- Tabela de Obras -->
    <div class="hvc-container">
      <h2 class="hvc-title">
        <i class="fas fa-list"></i> Lista de Obras
      </h2>
      <table id="obras-table" class="hvc-table">
        <thead>
          <tr>
            <th>Número</th>
            <th>Cliente</th>
            <th>Valor Total</th>
            <th>Status</th>
            <th>Serviços</th>
            <th>Medições</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          <tr><td colspan="7" style="text-align: center;">Carregando obras...</td></tr>
        </tbody>
      </table>
    </div>
  </main>

  <!-- Modal para Gerenciar Serviços -->
  <div id="servicos-modal" class="hvc-modal">
    <div class="hvc-modal-content">
      <span class="hvc-modal-close" id="modal-close-servicos">&times;</span>
      <h2 class="hvc-title">
        <i class="fas fa-tools"></i> Serviços da Obra
      </h2>
      <div id="obra-info-modal" style="text-align: center; margin-bottom: 2rem; font-size: 1.2rem; color: #ffffff;"></div>
      
      <!-- Formulário para adicionar serviço -->
      <form id="add-servico-form" class="hvc-form">
        <input type="text" id="servico-nome" class="hvc-input" placeholder="Nome do Serviço" required />
        <button type="submit" class="hvc-btn">
          <i class="fas fa-plus"></i> Adicionar Serviço
        </button>
      </form>

      <!-- Lista de serviços -->
      <div id="servicos-list">
        <!-- Serviços serão listados aqui -->
      </div>
    </div>
  </div>

  <!-- Modal para Gerenciar Medições -->
  <div id="medicoes-modal" class="hvc-modal">
    <div class="hvc-modal-content">
      <span class="hvc-modal-close" id="modal-close-medicoes">&times;</span>
      <h2 class="hvc-title">
        <i class="fas fa-ruler"></i> Medições da Obra
      </h2>
      <div id="obra-medicoes-info" style="text-align: center; margin-bottom: 2rem; font-size: 1.2rem; color: #ffffff;"></div>
      
      <!-- Formulário para adicionar medição -->
      <form id="add-medicao-form" class="hvc-form">
        <input type="text" id="medicao-numero" class="hvc-input" placeholder="Número da Medição (ex: 001)" required />
        <input type="date" id="medicao-data" class="hvc-input" required />
        <select id="medicao-status" class="hvc-select" required>
          <option value="">Status da Medição</option>
          <option value="Vai ser enviada">Vai ser enviada</option>
          <option value="Já foi enviada">Já foi enviada</option>
          <option value="Já foi recebida">Já foi recebida</option>
        </select>
        <button type="submit" class="hvc-btn">
          <i class="fas fa-plus"></i> Adicionar Medição
        </button>
      </form>

      <!-- Lista de medições -->
      <div id="medicoes-list">
        <!-- Medições serão listadas aqui -->
      </div>
    </div>
  </div>

  <!-- Modal para Serviços da Medição -->
  <div id="servicos-medicao-modal" class="hvc-modal">
    <div class="hvc-modal-content">
      <span class="hvc-modal-close" id="modal-close-servicos-medicao">&times;</span>
      <h2 class="hvc-title">
        <i class="fas fa-list-check"></i> Serviços da Medição
      </h2>
      <div id="medicao-info-modal" style="text-align: center; margin-bottom: 2rem; font-size: 1.2rem; color: #ffffff;"></div>
      
      <!-- Formulário para adicionar serviço à medição -->
      <form id="add-servico-medicao-form" class="hvc-form">
        <select id="servico-medicao-select" class="hvc-select" required>
          <option value="">Selecione o Serviço</option>
        </select>
        <textarea id="servico-observacoes" class="hvc-textarea" placeholder="Observações (opcional)" rows="2"></textarea>
        <button type="submit" class="hvc-btn">
          <i class="fas fa-plus"></i> Adicionar à Medição
        </button>
      </form>

      <!-- Lista de serviços da medição -->
      <div id="servicos-medicao-list">
        <!-- Serviços da medição serão listados aqui -->
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script type="module" src="supabase.js"></script>
  <script type="module" src="obras-hvc.js"></script>
  <script type="module">
    import { injectSidebar } from './sidebar.js';
    injectSidebar("main-content-obras-hvc");
  </script>
</body>
</html>

